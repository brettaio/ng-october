{"ast":null,"code":"import { HttpHeaders, HttpParams } from '@angular/common/http';\nimport { of } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../http-error-handler.service\";\nexport const searchUrl = '/packages/query';\nfunction createHttpOptions(packageName, refresh = false) {\n  // package name search api\n  // e.g., /packages/query?name=dom'\n  const params = new HttpParams({\n    fromObject: {\n      name: packageName\n    }\n  });\n  const headerMap = refresh ? {\n    'x-refresh': 'true'\n  } : {};\n  const headers = new HttpHeaders(headerMap);\n  return {\n    headers,\n    params\n  };\n}\nexport class PackageSearchService {\n  constructor(http, httpErrorHandler) {\n    this.http = http;\n    this.handleError = httpErrorHandler.createHandleError('PackageSearchService');\n  }\n  search(packageName, refresh = false) {\n    // clear if no pkg name\n    if (!packageName.trim()) {\n      return of([]);\n    }\n    const options = createHttpOptions(packageName, refresh);\n    return this.http.get(searchUrl, options).pipe(catchError(this.handleError('search', [])));\n  }\n  static #_ = this.ɵfac = function PackageSearchService_Factory(t) {\n    return new (t || PackageSearchService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.HttpErrorHandler));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: PackageSearchService,\n    factory: PackageSearchService.ɵfac\n  });\n}","map":{"version":3,"names":["HttpHeaders","HttpParams","of","catchError","searchUrl","createHttpOptions","packageName","refresh","params","fromObject","name","headerMap","headers","PackageSearchService","constructor","http","httpErrorHandler","handleError","createHandleError","search","trim","options","get","pipe","_","i0","ɵɵinject","i1","HttpClient","i2","HttpErrorHandler","_2","factory","ɵfac"],"sources":["c:\\brettaio\\ng-http\\src\\app\\package-search\\package-search.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\n\nimport { Observable, of } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\n\nimport { HttpErrorHandler, HandleError } from '../http-error-handler.service';\n\nexport interface NpmPackageInfo {\n  name: string;\n  version: string;\n  description: string;\n}\n\nexport const searchUrl = '/packages/query';\n\nfunction createHttpOptions(packageName: string, refresh = false) {\n    // package name search api\n    // e.g., /packages/query?name=dom'\n    const params = new HttpParams({ fromObject: { name: packageName } });\n    const headerMap: Record<string, string> = refresh ? {'x-refresh': 'true'} : {};\n    const headers = new HttpHeaders(headerMap) ;\n    return { headers, params };\n}\n\n@Injectable()\nexport class PackageSearchService {\n  private handleError: HandleError;\n\n  constructor(\n    private http: HttpClient,\n    httpErrorHandler: HttpErrorHandler) {\n    this.handleError = httpErrorHandler.createHandleError('PackageSearchService');\n  }\n\n  search(packageName: string, refresh = false): Observable<NpmPackageInfo[]> {\n    // clear if no pkg name\n    if (!packageName.trim()) { return of([]); }\n\n    const options = createHttpOptions(packageName, refresh);\n\n    return this.http.get<NpmPackageInfo[]>(searchUrl, options).pipe(\n      catchError(this.handleError('search', []))\n    );\n  }\n}\n"],"mappings":"AACA,SAAqBA,WAAW,EAAEC,UAAU,QAAQ,sBAAsB;AAE1E,SAAqBC,EAAE,QAAQ,MAAM;AACrC,SAASC,UAAU,QAAQ,gBAAgB;;;;AAU3C,OAAO,MAAMC,SAAS,GAAG,iBAAiB;AAE1C,SAASC,iBAAiBA,CAACC,WAAmB,EAAEC,OAAO,GAAG,KAAK;EAC3D;EACA;EACA,MAAMC,MAAM,GAAG,IAAIP,UAAU,CAAC;IAAEQ,UAAU,EAAE;MAAEC,IAAI,EAAEJ;IAAW;EAAE,CAAE,CAAC;EACpE,MAAMK,SAAS,GAA2BJ,OAAO,GAAG;IAAC,WAAW,EAAE;EAAM,CAAC,GAAG,EAAE;EAC9E,MAAMK,OAAO,GAAG,IAAIZ,WAAW,CAACW,SAAS,CAAC;EAC1C,OAAO;IAAEC,OAAO;IAAEJ;EAAM,CAAE;AAC9B;AAGA,OAAM,MAAOK,oBAAoB;EAG/BC,YACUC,IAAgB,EACxBC,gBAAkC;IAD1B,KAAAD,IAAI,GAAJA,IAAI;IAEZ,IAAI,CAACE,WAAW,GAAGD,gBAAgB,CAACE,iBAAiB,CAAC,sBAAsB,CAAC;EAC/E;EAEAC,MAAMA,CAACb,WAAmB,EAAEC,OAAO,GAAG,KAAK;IACzC;IACA,IAAI,CAACD,WAAW,CAACc,IAAI,EAAE,EAAE;MAAE,OAAOlB,EAAE,CAAC,EAAE,CAAC;;IAExC,MAAMmB,OAAO,GAAGhB,iBAAiB,CAACC,WAAW,EAAEC,OAAO,CAAC;IAEvD,OAAO,IAAI,CAACQ,IAAI,CAACO,GAAG,CAAmBlB,SAAS,EAAEiB,OAAO,CAAC,CAACE,IAAI,CAC7DpB,UAAU,CAAC,IAAI,CAACc,WAAW,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAC3C;EACH;EAAC,QAAAO,CAAA,G;qBAlBUX,oBAAoB,EAAAY,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,gBAAA;EAAA;EAAA,QAAAC,EAAA,G;WAApBlB,oBAAoB;IAAAmB,OAAA,EAApBnB,oBAAoB,CAAAoB;EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}